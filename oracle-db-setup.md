# Oracle DB Setup for MyWebApp

## Create T_CEF_QR_DETAILS Table

```sql
CREATE TABLE "T_CEF_QR_DETAILS"
(
    "Id" NUMBER(*,0) GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "Title" VARCHAR2(255 CHAR),
    "Description" VARCHAR2(255 CHAR),
    "Location" VARCHAR2(255 CHAR),
    "ForwardtoURL" VARCHAR2(2048 CHAR),
    "CreatedOn" DATE,
    "CreatedBy" VARCHAR2(255 CHAR)
);
```

## Create T_CEF_QR_RedirectLogs Table

```sql
CREATE TABLE "T_CEF_QR_RedirectLogs"
(
    "Id" NUMBER(*,0) GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "QRId" NUMBER NOT NULL,
    "IpAddress" VARCHAR2(45),
    "CreatedOn" DATE,
    CONSTRAINT "FK_RedirectLogs_QRDetails" FOREIGN KEY ("QRId") REFERENCES "T_CEF_QR_DETAILS"("Id")
);
```

## Create T_CODE_MASTER Table

```sql
CREATE TABLE "T_CODE_MASTER"
(
    "TCM_CODE_ID" VARCHAR2(20 CHAR) NOT NULL PRIMARY KEY,
    "TCM_CODE_DES" VARCHAR2(255 CHAR),
    "TCM_TYPE_ID" VARCHAR2(20 CHAR)
);
```

## Sample Data Insert

```sql
-- Insert sample locations
INSERT INTO "T_CODE_MASTER" ("TCM_CODE_ID", "TCM_CODE_DES", "TCM_TYPE_ID") VALUES ('NYC', 'New York', 'LOCATION');
INSERT INTO "T_CODE_MASTER" ("TCM_CODE_ID", "TCM_CODE_DES", "TCM_TYPE_ID") VALUES ('LAX', 'Los Angeles', 'LOCATION');
INSERT INTO "T_CODE_MASTER" ("TCM_CODE_ID", "TCM_CODE_DES", "TCM_TYPE_ID") VALUES ('CHI', 'Chicago', 'LOCATION');
INSERT INTO "T_CODE_MASTER" ("TCM_CODE_ID", "TCM_CODE_DES", "TCM_TYPE_ID") VALUES ('HOU', 'Houston', 'LOCATION');
INSERT INTO "T_CODE_MASTER" ("TCM_CODE_ID", "TCM_CODE_DES", "TCM_TYPE_ID") VALUES ('PHX', 'Phoenix', 'LOCATION');
INSERT INTO "T_CODE_MASTER" ("TCM_CODE_ID", "TCM_CODE_DES", "TCM_TYPE_ID") VALUES ('PHI', 'Philadelphia', 'LOCATION');
INSERT INTO "T_CODE_MASTER" ("TCM_CODE_ID", "TCM_CODE_DES", "TCM_TYPE_ID") VALUES ('SAN', 'San Antonio', 'LOCATION');
INSERT INTO "T_CODE_MASTER" ("TCM_CODE_ID", "TCM_CODE_DES", "TCM_TYPE_ID") VALUES ('DAL', 'Dallas', 'LOCATION');

-- Insert sample QR details (note: Location field stores the CODE_ID, not the description)
INSERT INTO "T_CEF_QR_DETAILS" ("Title", "Description", "Location", "ForwardtoURL", "CreatedOn", "CreatedBy") 
VALUES ('Google Search', 'Quick access to Google', 'NYC', 'https://www.google.com', SYSDATE, 'System');

INSERT INTO "T_CEF_QR_DETAILS" ("Title", "Description", "Location", "ForwardtoURL", "CreatedOn", "CreatedBy") 
VALUES ('Test URL', 'Test Description', 'DAL', 'https://www.example.com', SYSDATE, 'System');

COMMIT;
```

## Fix for T_CEF_QR_RedirectLogs Identity Column Issue

If you're getting "ORA-01400: cannot insert NULL into Id" error, your table wasn't created with IDENTITY. Run these commands:

```sql
-- Drop and recreate the T_CEF_QR_RedirectLogs table with proper IDENTITY column
DROP TABLE "T_CEF_QR_RedirectLogs";

CREATE TABLE "T_CEF_QR_RedirectLogs"
(
    "Id" NUMBER(*,0) GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    "QRId" NUMBER NOT NULL,
    "IpAddress" VARCHAR2(45),
    "CreatedOn" DATE,
    CONSTRAINT "FK_RedirectLogs_QRDetails" FOREIGN KEY ("QRId") REFERENCES "T_CEF_QR_DETAILS"("Id")
);
```

## Drop Tables (if needed)

```sql
DROP TABLE "T_CEF_QR_RedirectLogs";
DROP TABLE "T_CEF_QR_DETAILS";
DROP TABLE "T_CODE_MASTER";
```

## Check Tables

```sql
-- Check if tables exist
SELECT table_name FROM user_tables WHERE table_name IN ('T_CEF_QR_DETAILS', 'T_CEF_QR_RedirectLogs', 'T_CODE_MASTER');

-- View table structure
DESC "T_CEF_QR_DETAILS";
DESC "T_CEF_QR_RedirectLogs";
DESC "T_CODE_MASTER";

-- View data
SELECT * FROM "T_CEF_QR_DETAILS";
SELECT * FROM "T_CEF_QR_RedirectLogs";
SELECT * FROM "T_CODE_MASTER";
```
